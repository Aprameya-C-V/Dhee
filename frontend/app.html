<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dhee • Learn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: {
                DEFAULT: '#2563eb',
                50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd',
                400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8',
                800: '#1e40af', 900: '#1e3a8a'
              }
            }
          }
        }
      }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Markdown renderer and sanitizer -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.7/dist/purify.min.js"></script>
    <style>
      body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
      .glass { background: rgba(255,255,255,0.6); backdrop-filter: blur(10px); }
      .shadow-soft { box-shadow: 0 10px 30px rgba(0,0,0,0.06); }
      .scrollbar-thin::-webkit-scrollbar { height: 8px; width: 8px; }
      .scrollbar-thin::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 8px; }
      /* Simple markdown styles */
      #output h1 { font-size: 1.5rem; font-weight: 700; margin: 0.75rem 0; }
      #output h2 { font-size: 1.25rem; font-weight: 600; margin: 0.6rem 0; }
      #output h3 { font-size: 1.125rem; font-weight: 600; margin: 0.5rem 0; }
      #output p { margin: 0.5rem 0; }
      #output ul { margin-left: 1rem; list-style: disc; }
      #output ol { margin-left: 1rem; list-style: decimal; }
      #output code { background: #f1f5f9; padding: 0.1rem 0.25rem; border-radius: 0.25rem; }
    </style>
  </head>
  <body class="h-full bg-gradient-to-br from-blue-50 via-white to-blue-100">
    <div class="min-h-full flex flex-col">
      <!-- Header -->
      <header class="sticky top-0 z-20 bg-white/70 backdrop-blur border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-xl bg-primary-600 text-white grid place-items-center font-bold">D</div>
            <div>
              <h1 class="text-xl font-bold text-slate-800">Dhee</h1>
              <p class="text-xs text-slate-500">AI-Powered Regional & Sub-Regional Personalized Tutor</p>
            </div>
          </div>
          <div class="flex items-center gap-2 text-xs text-slate-500">
            <span class="hidden sm:block">Low-bandwidth optimized</span>
            <span class="w-2 h-2 rounded-full bg-green-500"></span>
          </div>
        </div>
      </header>

      <!-- Main -->
      <main class="flex-1">
        <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
          <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Controls -->
            <aside class="lg:col-span-4 xl:col-span-3 glass rounded-2xl p-4 shadow-soft">
              <h2 id="titlePersonalization" class="text-lg font-semibold text-slate-800 mb-3">Personalization</h2>
              <div class="space-y-4">
                <div>
                  <label id="labelRegion" class="text-sm text-slate-600">Region</label>
                  <select id="region" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500"></select>
                </div>
                <div>
                  <label id="labelSubregion" class="text-sm text-slate-600">Sub-region</label>
                  <select id="subregion" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500"></select>
                </div>
                <div>
                  <label id="labelLanguage" class="text-sm text-slate-600">Language</label>
                  <select id="language" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500"></select>
                </div>
                <div>
                  <label id="labelUiLanguage" class="text-sm text-slate-600">UI Language</label>
                  <select id="uiLanguage" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500">
                    <option value="en">English</option>
                    <option value="hi">हिन्दी</option>
                    <option value="bn">বাংলা</option>
                    <option value="ta">தமிழ்</option>
                    <option value="te">తెలుగు</option>
                    <option value="kn">ಕನ್ನಡ</option>
                    <option value="mr">मराठी</option>
                    <option value="gu">ગુજરાતી</option>
                    <option value="ml">മലയാളം</option>
                    <option value="pa">ਪੰਜਾਬੀ</option>
                    <option value="or">ଓଡ଼ିଆ</option>
                    <option value="as">অসমীয়া</option>
                    <option value="ur">اردو</option>
                    <option value="ar">العربية</option>
                    <option value="es">Español</option>
                    <option value="fr">Français</option>
                    <option value="pt">Português</option>
                    <option value="sw">Kiswahili</option>
                    <option value="am">አማርኛ</option>
                    <option value="so">Soomaali</option>
                    <option value="ha">Hausa</option>
                    <option value="uz">O‘zbekcha</option>
                    <option value="tg">Тоҷикӣ</option>
                    <option value="ru">Русский</option>
                    <option value="ps">پښتو</option>
                    <option value="fa">دری / فارسی</option>
                  </select>
                </div>
                <div>
                  <label id="labelDomain" class="text-sm text-slate-600">Domain</label>
                  <select id="domain" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500">
                    <option>Literacy</option>
                    <option>Numeracy</option>
                    <option>STEM</option>
                    <option>Digital Literacy</option>
                    <option>AI Literacy</option>
                  </select>
                </div>
                <div>
                  <label id="labelGrade" class="text-sm text-slate-600">Grade level</label>
                  <select id="grade" class="mt-1 w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500">
                    <option value="Primary">Primary</option>
                    <option value="Middle">Middle</option>
                    <option value="Secondary">Secondary</option>
                  </select>
                </div>
                <div class="flex items-center justify-between">
                  <span id="labelLowData" class="text-sm text-slate-600">Low data mode</span>
                  <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="lowData" class="sr-only peer">
                    <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all relative peer-checked:bg-primary-600"></div>
                  </label>
                </div>
              </div>

              <h2 id="titlePresets" class="text-lg font-semibold text-slate-800 mt-6 mb-3">Presets</h2>
              <div id="presetList" class="space-y-2"></div>
              <div class="grid grid-cols-2 gap-2 mt-2">
                <button id="startPresetBtn" class="w-full bg-white border hover:bg-slate-50 rounded-xl px-4 py-2 text-slate-700 font-medium">Start Preset</button>
                <button id="nextLessonBtn" class="w-full bg-white border hover:bg-slate-50 rounded-xl px-4 py-2 text-slate-700 font-medium">Next Lesson</button>
              </div>

              <h2 id="titleIllustrations" class="text-lg font-semibold text-slate-800 mt-6 mb-3">Illustrations</h2>
              <div class="space-y-3">
                <div class="flex items-center justify-between">
                  <span id="labelAutoSee" class="text-sm text-slate-600">See (auto visuals)</span>
                  <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="autoSee" class="sr-only peer" checked disabled>
                    <div class="w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all relative peer-checked:bg-primary-600"></div>
                  </label>
                </div>
                <input id="imagePrompt" type="text" placeholder="Describe an illustration to generate..." class="w-full border rounded-xl px-3 py-2 bg-white focus:ring-2 focus:ring-primary-500" />
                <button id="genImageBtn" class="w-full bg-primary-600 hover:bg-primary-700 text-white rounded-xl px-4 py-2 font-medium">Generate Illustration</button>
              </div>
            </aside>

            <!-- Output + Illustration -->
            <section class="lg:col-span-8 xl:col-span-9 space-y-4">
              <div class="grid grid-cols-1 xl:grid-cols-12 gap-4">
                <div class="xl:col-span-7">
                  <div class="glass rounded-2xl p-4 shadow-soft h-[70vh] overflow-y-auto scrollbar-thin" id="chatContainer">
                    <div id="output" class="text-slate-800 text-sm leading-6"></div>
                  </div>
                  <div class="flex gap-3 mt-3">
                    <input id="userInput" type="text" placeholder="Ask a question or request a lesson..." class="flex-1 border rounded-2xl px-4 py-3 bg-white focus:ring-2 focus:ring-primary-500" />
                    <button id="sendBtn" class="bg-primary-600 hover:bg-primary-700 text-white rounded-2xl px-6 py-3 font-semibold">Send</button>
                  </div>
                </div>
                <div class="xl:col-span-5">
                  <div class="glass rounded-2xl p-2 shadow-soft h-[70vh] flex flex-col">
                    <div class="flex-1 rounded-xl bg-white grid place-items-center overflow-hidden border">
                      <img id="currentIllustration" alt="Current illustration" class="max-w-full max-h-full object-contain" />
                    </div>
                    <div id="illustrationCaption" class="text-xs text-slate-600 mt-2 px-2 line-clamp-3"></div>
                  </div>
                </div>
              </div>

              <div>
                <h3 id="titleGenerated" class="text-sm font-semibold text-slate-700 mb-2">Generated Illustrations</h3>
                <div id="gallery" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"></div>
              </div>
            </section>
          </div>
        </div>
      </main>

      <footer class="py-6 text-center text-xs text-slate-500">Built for equitable education • Mobile-first • Region-aware</footer>
    </div>

    <script src="/scripts/app.js" type="module"></script>
  </body>
</html>
